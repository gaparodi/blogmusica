{% extends 'musica/base.html' %}
{% block title %}{{ lanzamiento.titulo|default:"Lanzamiento" }}{% endblock %}

{% block content %}
<div class="container my-4">
  <nav class="mb-3">
    <a href="{% url 'musica:lista_lanzamientos' %}" class="text-decoration-none">← Volver</a>
  </nav>

  <div class="row g-4">
    <div class="col-md-4">
      {# Imagen del lanzamiento (sin texto debajo) #}
      {% if lanzamiento.imagen %}
        <img src="{{ lanzamiento.imagen.url }}" alt="{{ lanzamiento.titulo|default:'Lanzamiento' }}" class="img-fluid rounded shadow-sm">
      {% elif lanzamiento.portada %}
        <img src="{{ lanzamiento.portada.url }}" alt="{{ lanzamiento.titulo|default:'Lanzamiento' }}" class="img-fluid rounded shadow-sm">
      {% elif lanzamiento.artista and lanzamiento.artista.imagen %}
        <img src="{{ lanzamiento.artista.imagen.url }}" alt="{{ lanzamiento.artista.nombre }}" class="img-fluid rounded shadow-sm">
      {% else %}
        <div class="bg-secondary rounded" style="width:100%; padding-top:100%;"></div>
      {% endif %}
    </div>

    <div class="col-md-8">
      <h1 class="mb-2">{{ lanzamiento.titulo|default:"(Sin título)" }}</h1>

      {% if lanzamiento.artista %}
        <p class="mb-1">
          <strong>Artista:</strong>
          <a href="{% url 'musica:artista_detalle' lanzamiento.artista.pk %}">{{ lanzamiento.artista.nombre }}</a>
        </p>
      {% endif %}

      {% if lanzamiento.fecha_lanzamiento %}
        <p class="text-muted">Fecha: {{ lanzamiento.fecha_lanzamiento|date:"d/m/Y" }}</p>
      {% elif lanzamiento.fecha %}
        {# fallback por si el modelo tuviera 'fecha' en proyectos previos #}
        <p class="text-muted">Fecha: {{ lanzamiento.fecha|date:"d/m/Y" }}</p>
      {% endif %}

      {% if lanzamiento.descripcion %}
        <div class="mt-3">{{ lanzamiento.descripcion|linebreaks }}</div>
      {% endif %}

      {% if lanzamiento.enlace or lanzamiento.link %}
        <div class="mt-3">
          <a href="{{ lanzamiento.enlace|default:lanzamiento.link }}" target="_blank" rel="noopener" class="btn btn-primary">Escuchar / Ver</a>
        </div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}